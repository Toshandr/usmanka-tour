<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{{ tour.title }} — Усманка-уикенд</title>
  <meta name="description" content="{{ tour.description }}" />
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#4CAF50',
            accent: '#FF9800',
            'dark-bg': '#0a0a0a',
            'dark-card': '#111111',
            'dark-border': '#333333'
          }
        }
      }
    }
  </script>

  <style>
    html { scroll-behavior: smooth; }
    .glass {
      background: linear-gradient(135deg, rgba(17,17,17,0.9), rgba(10,10,10,0.9));
      backdrop-filter: blur(10px);
      border: 1px solid rgba(51,51,51,0.5);
    }
    .gradient-text {
      background: linear-gradient(90deg, #4CAF50, #FF9800);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .feature-card:hover {
      transform: translateY(-5px);
      transition: transform 0.3s ease;
    }
    .btn-primary {
      background: linear-gradient(90deg, #4CAF50, #689F38);
      transition: all 0.3s ease;
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(76, 175, 80, 0.3);
    }
    body {
      background: linear-gradient(to bottom, #000000, #0a0a0a, #000000);
    }
  </style>
</head>
<body class="text-slate-100 antialiased">

  <div class="max-w-6xl mx-auto px-4 sm:px-6">

    <!-- Header -->
    <header class="flex items-center justify-between py-6 sticky top-0 z-30 bg-black/80 backdrop-blur-md">
      <a href="/" class="flex items-center gap-3">
        <div class="w-12 h-12 rounded-xl bg-gradient-to-tr from-primary to-accent flex items-center justify-center font-bold text-white shadow-lg">
          <i class="fas fa-leaf"></i>
        </div>
        <div>
          <h1 class="text-lg font-semibold leading-tight">{{ tour.title }}</h1>
          <p class="text-xs text-slate-400">20–21 июня 2026</p>
        </div>
      </a>
      <nav class="hidden md:flex items-center gap-6 text-sm text-slate-300">
        <a href="#about" class="hover:text-primary transition-colors">О туре</a>
        <a href="#schedule" class="hover:text-primary transition-colors">Расписание</a>
        <a href="#tariffs" class="hover:text-primary transition-colors">Тарифы</a>
        <a href="#contact" class="px-4 py-2 btn-primary rounded-lg text-white font-medium">Забронировать</a>
      </nav>
    </header>

    <!-- Hero -->
    <section id="about" class="mt-10 mb-20">
      <div class="text-center mb-10">
        <h2 class="text-4xl md:text-5xl font-extrabold leading-tight mb-4">
          {{ tour.title.split(' на ')[0] }} на <span class="gradient-text">Усманке</span>
        </h2>
        <p class="text-xl text-slate-300 max-w-3xl mx-auto">
          {{ tour.description }}
        </p>
      </div>

      <div class="relative overflow-hidden rounded-2xl mb-10">
        <img src="{{ tour.image }}" alt="{{ tour.title }}" class="w-full h-96 object-cover" />
      </div>

      <!-- 1. Архитектура тура -->
      <div class="glass p-8 rounded-2xl mb-10 feature-card transition-all">
        <h3 class="text-2xl font-bold mb-6">1. Архитектура тура</h3>
        <ul class="space-y-3 text-slate-300">
          {% for item in tour.architecture %}
          <li class="flex items-start gap-3">
            <i class="fas fa-check text-primary mt-1"></i>
            <span>{{ item }}</span>
          </li>
          {% endfor %}
        </ul>
      </div>

      <!-- 2. ЭТО ДЛЯ ВАС если -->
      <div class="glass p-8 rounded-2xl mb-10 feature-card transition-all">
        <h3 class="text-2xl font-bold mb-6">2. ЭТО ДЛЯ ВАС если</h3>
        <ul class="space-y-3 text-slate-300">
          {% for item in tour.for_you %}
          <li class="flex items-start gap-3">
            <i class="fas fa-star text-accent mt-1"></i>
            <span>{{ item }}</span>
          </li>
          {% endfor %}
        </ul>
      </div>

      <!-- 3. Расписание -->
      <section id="schedule" class="glass p-8 rounded-2xl mb-10 feature-card transition-all">
        <h3 class="text-2xl font-bold mb-6">3. Расписание</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h4 class="text-xl font-semibold mb-4">День 1</h4>
            <div class="space-y-3">
              {% for time, title, desc in tour.schedule_day1 %}
              <div class="flex gap-4 p-3 rounded-lg hover:bg-dark-border transition-colors">
                <span class="text-primary font-semibold w-24">{{ time }}</span>
                <div>
                  <div class="font-medium">{{ title }}</div>
                  {% if desc %}
                  <div class="text-sm text-slate-400">{{ desc }}</div>
                  {% endif %}
                </div>
              </div>
              {% endfor %}
            </div>
          </div>

          <div>
            <h4 class="text-xl font-semibold mb-4">День 2</h4>
            <div class="space-y-3">
              {% for time, title, desc in tour.schedule_day2 %}
              <div class="flex gap-4 p-3 rounded-lg hover:bg-dark-border transition-colors">
                <span class="text-accent font-semibold w-24">{{ time }}</span>
                <div>
                  <div class="font-medium">{{ title }}</div>
                  {% if desc %}
                  <div class="text-sm text-slate-400">{{ desc }}</div>
                  {% endif %}
                </div>
              </div>
              {% endfor %}
            </div>
          </div>
        </div>
      </section>

      <!-- 4. Что получите -->
      <div class="glass p-8 rounded-2xl mb-10 feature-card transition-all">
        <h3 class="text-2xl font-bold mb-6">4. Что получите</h3>
        <ul class="space-y-3 text-slate-300">
          {% for item in tour.benefits %}
          <li class="flex items-start gap-3">
            <i class="fas fa-gift text-primary mt-1"></i>
            <span>{{ item }}</span>
          </li>
          {% endfor %}
        </ul>
      </div>

      <!-- 5. Тарифы -->
      <section id="tariffs" class="mb-10">
        <h3 class="text-2xl font-bold mb-6 text-center">5. Тарифы</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {% for tariff in tour.tariffs %}
          <div class="glass p-6 rounded-2xl feature-card transition-all hover:shadow-2xl">
            <div class="text-center mb-4">
              <h4 class="text-xl font-bold mb-2">{{ tariff.name }}</h4>
              <div class="text-4xl font-extrabold text-primary mb-2">
                {% if tariff.price == 0 %}
                По запросу
                {% else %}
                {{ tariff.price }} ₽
                {% endif %}
              </div>
              {% if tariff.wine > 0 %}
              <p class="text-xs text-slate-400">+ {{ tariff.wine }} ₽ винная дегустация</p>
              {% endif %}
            </div>
            
            <div class="space-y-2 mb-6 text-sm">
              {% if tariff.room != 'Нет' and tariff.room != '' %}
              <div class="flex items-start gap-2">
                <i class="fas fa-bed text-accent mt-1"></i>
                <span class="text-slate-300">{{ tariff.room }}</span>
              </div>
              {% endif %}
              {% if tariff.accommodation != 'Нет' and tariff.accommodation != '' %}
              <div class="flex items-start gap-2">
                <i class="fas fa-users text-accent mt-1"></i>
                <span class="text-slate-300">{{ tariff.accommodation }}</span>
              </div>
              {% endif %}
            </div>
            
            <button class="w-full btn-primary px-6 py-3 rounded-lg text-white font-semibold booking-btn hover:scale-105 transition-transform" data-tour="{{ tour_key }}" data-tariff="{{ tariff.name }}" data-price="{{ tariff.price }}">
              <i class="fas fa-check-circle mr-2"></i>Забронировать
            </button>
          </div>
          {% endfor %}
        </div>
      </section>

      <!-- 6. Ведущие -->
      <div class="glass p-8 rounded-2xl mb-10 feature-card transition-all">
        <h3 class="text-2xl font-bold mb-6">6. Ведущие</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          {% for name, role in tour.leaders %}
          <div class="flex items-start gap-4">
            <div class="w-16 h-16 rounded-full bg-primary/20 flex items-center justify-center flex-shrink-0">
              <i class="fas fa-user text-primary text-xl"></i>
            </div>
            <div>
              <h4 class="font-semibold text-lg">{{ name }}</h4>
              <p class="text-slate-300">{{ role }}</p>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>

      <!-- 7. FAQ -->
      {% if tour.faq_extra %}
      <section id="contact" class="glass p-8 rounded-2xl mb-10 feature-card transition-all">
        <h3 class="text-2xl font-bold mb-6">7. FAQ</h3>
        <div class="space-y-4">
          {% for i in range(0, tour.faq_extra|length, 2) %}
          <div class="p-4 rounded-lg bg-dark-card">
            <h4 class="font-semibold mb-2">{{ tour.faq_extra[i] }}</h4>
            <p class="text-slate-300 text-sm">{{ tour.faq_extra[i+1] }}</p>
          </div>
          {% endfor %}
        </div>
      </section>
      {% endif %}

    </section>

    <!-- Footer -->
    <footer class="border-t border-dark-border mt-12 py-8 mb-10">
      <div class="flex flex-col md:flex-row items-center justify-between gap-6 text-sm text-slate-400">
        <a href="/" class="flex items-center gap-3">
          <div class="w-8 h-8 rounded-lg bg-gradient-to-tr from-primary to-accent flex items-center justify-center font-bold text-white text-xs">
            <i class="fas fa-leaf"></i>
          </div>
          <div>← Назад к турам</div>
        </a>
        <div>© 2026 Усманка-уикенд — Все права защищены</div>
      </div>
    </footer>

  </div>

  <!-- Модальное окно оплаты -->
  <div id="paymentModal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/80 backdrop-blur-sm">
    <div class="glass p-8 rounded-2xl max-w-md w-full mx-4">
      <h3 class="text-2xl font-bold mb-4">Оплата тура</h3>
      <form id="paymentForm">
        <div class="space-y-4 mb-6">
          <div>
            <label class="block text-sm text-slate-300 mb-1">Имя</label>
            <input type="text" name="name" id="paymentName" class="w-full bg-dark-card border border-dark-border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary" required />
          </div>
          <div>
            <label class="block text-sm text-slate-300 mb-1">Телефон</label>
            <input type="tel" name="phone" id="paymentPhone" class="w-full bg-dark-card border border-dark-border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary" required />
          </div>
          <div>
            <label class="block text-sm text-slate-300 mb-1">Email</label>
            <input type="email" name="email" id="paymentEmail" class="w-full bg-dark-card border border-dark-border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary" required />
          </div>
          <div>
            <label class="block text-sm text-slate-300 mb-1">Тариф</label>
            <input type="text" name="tariff" id="paymentTariff" readonly class="w-full bg-dark-card border border-dark-border rounded-lg px-4 py-2 opacity-70" />
          </div>
          <div>
            <label class="block text-sm text-slate-300 mb-1">Сумма</label>
            <input type="text" name="amount" id="paymentAmount" readonly class="w-full bg-dark-card border border-dark-border rounded-lg px-4 py-2 font-bold text-primary opacity-70" />
          </div>
          <input type="hidden" name="tour" id="paymentTour" />
        </div>
        <div class="flex gap-3">
          <button type="submit" class="flex-1 btn-primary px-6 py-3 rounded-lg text-white font-medium">
            Отправить заявку
          </button>
          <button type="button" onclick="closePayment()" class="px-6 py-3 border border-dark-border rounded-lg hover:bg-dark-border">
            Отмена
          </button>
        </div>
      </form>
    </div>
  </div>

  <script src="/static/js/common.js"></script>
  <script>
    document.body.dataset.tourType = '{{ tour_key }}';
  </script>

  <!-- 7. Условия -->
  {% set included = [] %}
      {% set toBring = [] %}
      {% if tour is defined %}
        {% if tour.conditions is defined and tour.conditions.included is defined %}
          {% set included = tour.conditions.included %}
        {% elif tour.included is defined %}
          {% set included = tour.included %}
        {% endif %}

        {% if tour.conditions is defined and tour.conditions.toBring is defined %}
          {% set toBring = tour.conditions.toBring %}
        {% elif tour.what_to_bring is defined %}
          {% set toBring = tour.what_to_bring %}
        {% endif %}
      {% endif %}

      {% if included | length > 0 or toBring | length > 0 %}
      <section class="glass p-8 rounded-2xl mb-10 feature-card transition-all">
        <h3 class="text-2xl font-bold mb-6">7. Условия</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h4 class="text-lg font-semibold mb-3">Включено в тур:</h4>
            <ul class="space-y-2 text-slate-300">
              {% for item in included %}
              <li class="flex items-start gap-3">
                <i class="fas fa-check text-primary mt-1"></i>
                <span>{{ item }}</span>
              </li>
              {% endfor %}
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-3">Необходимо взять с собой:</h4>
            <ul class="space-y-2 text-slate-300">
              {% if toBring and toBring[0] is mapping %}
                {% for group in toBring %}
                  {% for it in group.items %}
                  <li class="flex items-start gap-3">
                    <i class="fas fa-arrow-right text-accent mt-1"></i>
                    <span>{{ it }}</span>
                  </li>
                  {% endfor %}
                {% endfor %}
              {% else %}
                {% for item in toBring %}
                <li class="flex items-start gap-3">
                  <i class="fas fa-arrow-right text-accent mt-1"></i>
                  <span>{{ item }}</span>
                </li>
                {% endfor %}
              {% endif %}
            </ul>
          </div>
        </div>
      </section>
      {% endif %}

      <!-- 8. FAQ -->
      {% if tour.faq or tour.faq_extra %}
      <section id="contact" class="glass p-8 rounded-2xl mb-10 feature-card transition-all">
        <h3 class="text-2xl font-bold mb-6">8. FAQ</h3>
        <div class="space-y-4">
          {% if tour.faq is defined and tour.faq %}
            {% for q in tour.faq %}
            <div class="p-4 rounded-lg bg-dark-card">
              <h4 class="font-semibold mb-2">{{ q.question }}</h4>
              <p class="text-slate-300 text-sm">{{ q.answer }}</p>
            </div>
            {% endfor %}
          {% endif %}
          {% if tour.faq_extra is defined and tour.faq_extra %}
            {% for i in range(0, tour.faq_extra|length, 2) %}
            <div class="p-4 rounded-lg bg-dark-card">
              <h4 class="font-semibold mb-2">{{ tour.faq_extra[i] }}</h4>
              <p class="text-slate-300 text-sm">{{ tour.faq_extra[i+1] }}</p>
            </div>
            {% endfor %}
          {% endif %}
        </div>
      </section>
      {% endif %}
</html>
